<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bootstrap Scratchpad</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
        rel="stylesheet" />
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            font-family: "Inter", sans-serif;
        }

        .modal.fade .modal-dialog {
          transform: scale(1.05);
          opacity: 0;
          transition: transform 0.3s ease-out, opacity 0.3s ease-out, perspective 0.3s ease-out;
          perspective: 10px;
        }

        .modal.fade.show .modal-dialog {
          transform: scale(1);
          perspective: 0px;
          opacity: 1;
        }


        .main-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .split-view {
            display: flex;
            flex-grow: 1;
            height: calc(100% - 56px);
        }

        #editor-container,
        #preview {
            flex: 1;
            height: 100%;
            overflow: auto;
            padding: 0;
        }

        #editor,
        #snippet-code-editor {
            width: 100%;
            height: 100%;
            border: none;
            outline: none;
            resize: none;
        }

        #preview-iframe {
            width: 100%;
            height: 100%;
            border: none;
            background-color: #212529;
        }

        .navbar .form-control {
            background-color: #343a40;
            border-color: #495057;
            color: #f8f9fa;
        }

        #html-code {
            background-color: #212529;
            color: #f8f9fa;
            border-radius: 0.25rem;
            max-height: 60vh;
        }

        #htmlModal>.modal-dialog {
            height: 40vh;
        }

        #htmlModal .modal-footer {
            height: 3.5rem;
            padding: 0.3rem;
        }

        .ace_editor {
            font-size: 16px !important;
        }

        .dropdown-menu {
            max-height: 70vh;
            overflow-y: auto;
        }

        #snippet-code-editor-container {
            height: 250px;
            border-radius: 0.25rem;
            border: 1px solid #495057;
        }

        .modal-footer .docs-link {
            margin-right: auto;
        }

        .modal-body {
            overflow: auto;
            max-height: 60vh;
        }

        .modal-body>pre {
            overflow: visible;
        }

        .nav-buttons .btn:hover {
            background: none;
        }

        .btn {
            transition: background 50ms ease-in-out, color 50ms ease-in-out;
        }

        @media (max-width: 768px) {
            .split-view {
                display: flex;
                flex-direction: column;
            }

            #title-input {
                max-width: 220px;
            }

            .nav-title,
            .nav-file-icon {
                display: none;
            }

            .nav-bs-icon {
                margin-left: 3px;
                margin-right: 0 !important;
            }
        }
    </style>
</head>

<body>
    <div class="main-container">
        <nav class="navbar navbar-expand-lg bg-body-tertiary border-bottom">
            <div class="container-fluid">
                <a class="navbar-brand" href="#"><i class="bi bi-bootstrap-fill me-2 nav-bs-icon"></i><span
                        class="nav-title">Scratchpad</span></a>
                <div class="d-flex flex-grow-1 px-md-5">
                    <input type="text" id="title-input" class="form-control" placeholder="Untitled Document"
                        aria-describedby="basic-addon1" />
                </div>
                <div class="d-flex align-items-center nav-buttons">
                    <div class="dropdown">
                        <button class="btn btn-outline-secondary border-0 me-2" type="button" data-bs-toggle="dropdown"
                            aria-expanded="false" title="Insert Snippet">
                            <i class="bi bi-plus-circle fs-5"></i>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end" id="snippets-menu"></ul>
                    </div>
                    <button id="get-html-btn" class="btn btn-outline-secondary border-0" title="Get full HTML">
                        <i class="bi bi-code-slash fs-5"></i>
                    </button>
                    <button class="btn btn-outline-secondary border-0 ms-2" type="button" data-bs-toggle="modal"
                        data-bs-target="#settingsModal" title="Settings">
                        <i class="bi bi-gear fs-5"></i>
                    </button>
                </div>
            </div>
        </nav>
        <div class="split-view border-top">
            <div id="editor-container">
                <div id="editor"></div>
            </div>
            <div id="preview" class="border-start"><iframe id="preview-iframe" title="Preview"></iframe></div>
        </div>
    </div>
    <div class="modal fade" id="htmlModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="htmlModalLabel">Full HTML</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" title="Close"></button>
                </div>
                <div class="modal-body">
                    <pre><code id="html-code" class="language-html"></code></pre>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="copy-html-btn" title="Copy to clipboard"><i
                            class="bi bi-clipboard me-2"></i>Copy</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="settingsModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Settings</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" title="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="editor-theme-select" class="form-label">Editor Theme</label>
                        <select class="form-select" id="editor-theme-select"></select>
                    </div>
                    <div class="form-check form-switch mb-3"><input class="form-check-input" type="checkbox"
                            role="switch" id="word-wrap-toggle" /><label class="form-check-label"
                            for="word-wrap-toggle">Word Wrap</label></div>
                    <div class="row">
                        <div class="col"><label for="font-size-input" class="form-label">Font Size</label><input
                                type="number" class="form-control" id="font-size-input" min="8" max="32" value="16" />
                        </div>
                        <div class="col"><label for="tab-size-input" class="form-label">Tab Size</label><input
                                type="number" class="form-control" id="tab-size-input" min="1" max="8" value="4" />
                        </div>
                    </div>
                </div>
                <div class="modal-footer"><button type="button" class="btn btn-primary" data-bs-dismiss="modal"
                        title="Save and close">Done</button></div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="addSnippetModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">New Snippet</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" title="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="snippet-title-input" class="form-label">Snippet Title</label>
                        <input type="text" class="form-control" id="snippet-title-input"
                            placeholder="e.g., My Custom Card" title="Enter a title for your snippet" />
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Snippet Code</label>
                        <div id="snippet-code-editor-container">
                            <div id="snippet-code-editor"></div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <a href="https://getbootstrap.com/docs" target="_blank" class="btn btn-outline-secondary docs-link"
                        title="Open Bootstrap Documentation in a new tab">
                        <i class="bi bi-box-arrow-up-right me-2"></i>Bootstrap Docs
                    </a>
                    <button type="button" class="btn" data-bs-dismiss="modal"
                        title="Cancel snippet creation">Cancel</button>
                    <button type="button" class="btn btn-primary" id="save-snippet-btn"
                        title="Save the new snippet">Save Snippet</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.4/ace.js"></script>
    <script>
        const titleInput = document.getElementById("title-input");
        const getHtmlBtn = document.getElementById("get-html-btn");
        const htmlModal = new bootstrap.Modal(document.getElementById("htmlModal"));
        const addSnippetModal = new bootstrap.Modal(document.getElementById("addSnippetModal"));
        const htmlCodeEl = document.getElementById("html-code");
        const htmlModalLabel = document.getElementById("htmlModalLabel");
        const copyHtmlBtn = document.getElementById("copy-html-btn");
        const snippetsMenu = document.getElementById("snippets-menu");
        const wordWrapToggle = document.getElementById("word-wrap-toggle");
        const snippetTitleInput = document.getElementById("snippet-title-input");
        const saveSnippetBtn = document.getElementById("save-snippet-btn");
        const editorThemeSelect = document.getElementById("editor-theme-select");
        const fontSizeInput = document.getElementById("font-size-input");
        const tabSizeInput = document.getElementById("tab-size-input");
        const previewIframe = document.getElementById("preview-iframe");
        const docStorageKey = "bs-scratchpad-document-data";
        const settingsStorageKey = "bs-scratchpad-settings";
        const snippetsStorageKey = "bs-scratchpad-snippets";
        const editor = ace.edit("editor");
        const snippetEditor = ace.edit("snippet-code-editor");

        [editor, snippetEditor].forEach((ed) => {
            ed.session.setMode("ace/mode/html");
        });

        const defaultSnippets = {
            "Button": `<button type="button" class="btn btn-primary">Primary</button>`,
            "Form Input": `<div class="mb-3">\n  <label for="exampleFormControlInput1" class="form-label">Email address</label>\n  <input type="email" class="form-control" id="exampleFormControlInput1" placeholder="name@example.com">\n</div>`,
            "Card": `<div class="card" style="width: 18rem;">\n  <img src="https://placehold.co/600x400/343a40/ffffff?text=Image" class="card-img-top" alt="...">\n  <div class="card-body">\n    <h5 class="card-title">Card title</h5>\n    <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>\n    <a href="#" class="btn btn-primary">Go somewhere</a>\n  </div>\n</div>`,
            "Alert": `<div class="alert alert-primary" role="alert">\n  A simple primary alert—check it out!\n</div>`,
        }

        const editorThemes = {
            "Tomorrow Night": "ace/theme/tomorrow_night",
            "Monokai": "ace/theme/monokai",
            "GitHub": "ace/theme/github_dark",
            "Solarized Dark": "ace/theme/solarized_dark",
            "Cobalt": "ace/theme/cobalt",
        }

        const createBootstrapIcon = (iconName) => {
            const icon = document.createElement('i');
            icon.classList.add('bi', `bi-${iconName}`, 'me-2');
            return icon;
        }

        const getIframeContent = (userCode) => {
            const title = titleInput.value || "Document";
            return `<!DOCTYPE html>
            <html lang="en" data-bs-theme="dark">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>${title}</title>
                    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
                    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
                    <style>
                        body {
                            padding: 1.5rem;
                        }
                    </style>
                </head>
                <body>
                    <div class="app">
                        ${userCode}
                    </div>
                    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"><\/script>
                </body>
            </html>`;
        }


        const updatePreview = () => {
            const code = editor.getValue();
            previewIframe.srcdoc = code.trim()
                ? getIframeContent(code)
                : `<!DOCTYPE html><html lang="en" data-bs-theme="dark" style="background-color: #111111;"><head><title>Preview</title><link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet"><style>body, html { margin: 0; padding: 0; height: 100vh; display: flex; justify-content: center; align-items: center; background-color: #111111; color: #6c757d; flex-direction: column; font-family: sans-serif; } i { font-size: 4rem; margin-bottom: 1rem; animation: fade-in 1s linear } @keyframes fade-in {from {opacity:0;filter:blur(5px);} to {opacity:1;filter:blur(0px);}}</style></head><body><i class="bi bi-eye"></i></body></html>`;
        }

        const saveData = () => {
            localStorage.setItem(
                docStorageKey,
                JSON.stringify({
                    title: titleInput.value,
                    code: editor.getValue(),
                })
            );
        }

        const loadData = () => {
            const data = JSON.parse(localStorage.getItem(docStorageKey) || "{}");
            titleInput.value = data.title || "";
            editor.setValue(data.code || "", -1);
            updatePreview();
        }

        const saveSettings = () => {
            localStorage.setItem(
                settingsStorageKey,
                JSON.stringify({
                    theme: editorThemeSelect.value,
                    wordWrap: wordWrapToggle.checked,
                    fontSize: fontSizeInput.value,
                    tabSize: tabSizeInput.value,
                })
            );
        }

        const loadSettings = () => {
            Object.entries(editorThemes).forEach(([name, path]) => editorThemeSelect.add(new Option(name, path)));
            const settings = JSON.parse(localStorage.getItem(settingsStorageKey) || "{}");
            const theme = settings.theme || "ace/theme/tomorrow_night";
            const fontSize = settings.fontSize || 16;
            const tabSize = settings.tabSize || 4;
            editorThemeSelect.value = theme;
            wordWrapToggle.checked = settings.wordWrap === true;
            fontSizeInput.value = fontSize;
            tabSizeInput.value = tabSize;
            [editor, snippetEditor].forEach((ed) => {
                ed.setTheme(theme);
                ed.setFontSize(parseInt(fontSize));
                ed.session.setTabSize(parseInt(tabSize));
            });
            editor.session.setUseWrapMode(wordWrapToggle.checked);
        };
        const populateSnippets = () => {
            snippetsMenu.innerHTML = "";
            const createItem = (name, code) => {
                const a = document.createElement("a");
                a.className = "dropdown-item";
                a.href = "#";
                a.textContent = name;
                a.dataset.code = code;
                const li = document.createElement("li");
                li.appendChild(a);
                return li;
            };
            for (const [name, code] of Object.entries(defaultSnippets)) {
                snippetsMenu.appendChild(createItem(name, code));
            }
            const customSnippets = JSON.parse(localStorage.getItem(snippetsStorageKey) || "[]");
            if (customSnippets.length > 0) {
                const divider = document.createElement("li");
                divider.innerHTML = '<hr class="dropdown-divider">';
                snippetsMenu.appendChild(divider);
                customSnippets.forEach((s) => snippetsMenu.appendChild(createItem(s.title, s.code)));
            }
            const divider = document.createElement("li");
            divider.innerHTML = '<hr class="dropdown-divider">';
            snippetsMenu.appendChild(divider);
            const addBtnLi = document.createElement("li");
            const addBtnA = document.createElement("a");
            addBtnA.className = "dropdown-item";
            addBtnA.href = "#";
            addBtnA.innerHTML = `<i class="bi bi-plus-lg me-2"></i>New Snippet`;
            addBtnA.onclick = (e) => {
                e.preventDefault();
                snippetTitleInput.value = "";
                snippetEditor.setValue("", -1);
                addSnippetModal.show();
            };
            addBtnLi.appendChild(addBtnA);
            snippetsMenu.appendChild(addBtnLi);
        };

        snippetsMenu.addEventListener("click", (e) => {
            if (e.target.tagName === "A" && e.target.dataset.code) {
                e.preventDefault();
                editor.insert(e.target.dataset.code);
                editor.focus();
            }
        });

        saveSnippetBtn.addEventListener("click", () => {
            const ltitle = snippetTitleInput.value.trim();
            const code = snippetEditor.getValue().trim();
            if (!title || !code) return;
            const customSnippets = JSON.parse(localStorage.getItem(snippetsStorageKey) || "[]");
            customSnippets.push({
                title,
                code,
            });
            localStorage.setItem(snippetsStorageKey, JSON.stringify(customSnippets));
            populateSnippets();
            addSnippetModal.hide();
        });

        editor.session.on("change", () => {
            updatePreview();
            saveData();
        });

        titleInput.addEventListener("input", saveData);
        [editorThemeSelect, wordWrapToggle, fontSizeInput, tabSizeInput].forEach((el) =>
            el.addEventListener("change", () => {
                const newTheme = editorThemeSelect.value;
                const newFontSize = parseInt(fontSizeInput.value);
                const newTabSize = parseInt(tabSizeInput.value);
                [editor, snippetEditor].forEach((ed) => {
                    ed.setTheme(newTheme);
                    ed.setFontSize(newFontSize);
                    ed.session.setTabSize(newTabSize);
                });
                editor.session.setUseWrapMode(wordWrapToggle.checked);
                saveSettings();
            })
        );
        getHtmlBtn.addEventListener("click", () => {
            htmlModalLabel.textContent = titleInput.value || "Full HTML";
            htmlCodeEl.textContent = getIframeContent(editor.getValue());
            htmlModal.show();
        });
        copyHtmlBtn.addEventListener("click", () => {
            const tempTextArea = document.createElement("textarea");
            tempTextArea.value = htmlCodeEl.textContent;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand("copy");
            document.body.removeChild(tempTextArea);
            const originalText = copyHtmlBtn.innerHTML;
            copyHtmlBtn.innerHTML = '<i class="bi bi-check-lg me-2"></i>Copied!';
            setTimeout(() => {
                copyHtmlBtn.innerHTML = originalText;
            }, 2000);
        });
        document.addEventListener("DOMContentLoaded", () => {
            populateSnippets();
            loadSettings();
            loadData();
        });
    </script>
</body>

</html>